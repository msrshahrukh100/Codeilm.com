{"version":3,"file":"rpc-worker-loader.js","sources":["../src/rpc-worker-loader.js"],"sourcesContent":["/* global __webpack_exports__ */\n\nfunction workerSetup() {\n\taddEventListener('message', (e) => {\n\t\tlet { type, method, id, params } = e.data, f, p;\n\t\tif (type==='RPC' && method) {\n\t\t\tif ((f = __webpack_exports__[method])) {\n\t\t\t\tp = Promise.resolve().then( () => f.apply(__webpack_exports__, params) );\n\t\t\t}\n\t\t\telse {\n\t\t\t\tp = Promise.reject('No such method');\n\t\t\t}\n\t\t\tp.then(result => {\n\t\t\t\t\tpostMessage({ type: 'RPC', id, result });\n\t\t\t\t})\n\t\t\t\t.catch(e => {\n\t\t\t\t\tlet error = { message: e};\n\t\t\t\t\tif (e.stack) {\n\t\t\t\t\t\terror.message = e.message;\n\t\t\t\t\t\terror.stack = e.stack;\n\t\t\t\t\t\terror.name = e.name;\n\t\t\t\t\t}\n\t\t\t\t\tpostMessage({ type: 'RPC', id, error });\n\t\t\t\t});\n\t\t}\n\t});\n\tpostMessage({ type: 'RPC', method: 'ready' });\n}\n\nconst workerScript = '\\n' + Function.prototype.toString.call(workerSetup).replace(/(^.*\\{|\\}.*$|\\n\\s*)/g, '');\n\nexport default function rpcWorkerLoader(content) {\n\treturn content + workerScript;\n}\n"],"names":["let","const"],"mappings":"AAEA,SAAS,cAAc;IACtB,gBAAA,CAAiB,qBAAY;QAC5B,UAAmC,CAAA,CAAE;QAA/B;QAAM;QAAQ;QAAI;YAAmB,GAAG;QAC9C,IAAI,IAAA,KAAO,KAAP,IAAgB,QAAQ;YAC3B,IAAK,CAAA,GAAI,mBAAA,CAAoB,SAAU;gBACtC,CAAA,GAAI,OAAA,CAAQ,OAAR,EAAA,CAAkB,IAAlB,aAAwB,SAAM,CAAA,CAAE,KAAF,CAAQ,qBAAqB;mBAE3D;gBACJ,CAAA,GAAI,OAAA,CAAQ,MAAR,CAAe;;YAEpB,CAAA,CAAE,IAAF,WAAO;gBACL,WAAA,CAAY;oBAAE,MAAM,KAAR;wBAAe,EAAf;4BAAmB;;cADjC,CAGE,KAHF,WAGQ;gBACNA,IAAI,QAAQ;oBAAE,SAAS;;gBACvB,IAAI,CAAA,CAAE,OAAO;oBACZ,KAAA,CAAM,OAAN,GAAgB,CAAA,CAAE;oBAClB,KAAA,CAAM,KAAN,GAAc,CAAA,CAAE;oBAChB,KAAA,CAAM,IAAN,GAAa,CAAA,CAAE;;gBAEhB,WAAA,CAAY;oBAAE,MAAM,KAAR;wBAAe,EAAf;2BAAmB;;;;;IAInC,WAAA,CAAY;QAAE,MAAM,KAAR;QAAe,QAAQ;;;;AAGpCC,IAAM,eAAe,IAAA,GAAO,QAAA,CAAS,SAAT,CAAmB,QAAnB,CAA4B,IAA5B,CAAiC,YAAjC,CAA8C,OAA9C,CAAsD,wBAAwB;AAE1G,AAAe,SAAS,gBAAgB,SAAS;IAChD,OAAO,OAAA,GAAU;;;;;"}