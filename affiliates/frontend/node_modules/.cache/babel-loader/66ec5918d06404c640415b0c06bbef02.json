{"ast":null,"code":"import _classCallCheck from \"/home/shahrukh/Code/projects/allywith/Codeilm.com/lovecode/lovecodefrontend/lovecode/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/shahrukh/Code/projects/allywith/Codeilm.com/lovecode/lovecodefrontend/lovecode/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/shahrukh/Code/projects/allywith/Codeilm.com/lovecode/lovecodefrontend/lovecode/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/shahrukh/Code/projects/allywith/Codeilm.com/lovecode/lovecodefrontend/lovecode/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/shahrukh/Code/projects/allywith/Codeilm.com/lovecode/lovecodefrontend/lovecode/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/shahrukh/Code/projects/allywith/Codeilm.com/lovecode/lovecodefrontend/lovecode/src/containers/CreateTutorial/CreateTutorial.js\";\nimport React from 'react';\nimport axios from '../../lovecodeaxios';\nimport withErrorHandler from '../../hoc/withErrorHandler/withErrorHandler';\nimport { withStyles } from '@material-ui/core/styles';\nimport TextField from '@material-ui/core/TextField';\nimport { withRouter } from \"react-router\";\nimport Fab from '@material-ui/core/Fab';\nimport { MdGrade } from 'react-icons/md';\nimport { IconContext } from \"react-icons\";\nimport getCookie from '../../utils/getCookie';\nimport MediaCard from '../../components/UI/MediaCard/MediaCard';\nimport TutorialInfo from '../../components/TutorialInfo/TutorialInfo';\nimport { connect } from 'react-redux';\n\nvar styles = function styles(theme) {\n  return {\n    textField: {\n      width: '95%',\n      margin: theme.spacing()\n    },\n    repoField: {\n      minWidth: 120,\n      margin: theme.spacing()\n    },\n    container: {\n      position: 'absolute',\n      top: '90px',\n      width: '95%'\n    },\n    margin: {\n      margin: theme.spacing(),\n      textTransform: 'none'\n    },\n    extendedIcon: {\n      marginRight: theme.spacing()\n    }\n  };\n};\n\nvar CreateTutorial =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(CreateTutorial, _React$Component);\n\n  function CreateTutorial(_props) {\n    var _this;\n\n    _classCallCheck(this, CreateTutorial);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(CreateTutorial).call(this, _props));\n\n    _this.getBranchName = function (props) {\n      var query = new URLSearchParams(props.location.search);\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = query.entries()[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var param = _step.value;\n\n          if (param[0] === 'branch_name') {\n            return param[1];\n          }\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return != null) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      return null;\n    };\n\n    _this.titleUpdate = function (event) {\n      _this.setState({\n        title: event.target.value,\n        emptyError: event.target.value === \"\" ? true : false,\n        error: null\n      });\n    };\n\n    _this.createTutorial = function () {\n      _this.setState(function (prevState, props) {\n        return {\n          loading: prevState.title === \"\" ? false : true,\n          emptyError: prevState.title === \"\" ? true : false,\n          error: prevState.title === \"\" ? \"Title can't be blank\" : null\n        };\n      });\n\n      if (_this.state.title !== \"\") {\n        var csrftoken = getCookie('csrftoken');\n        var repoName = _this.props.match.params.repoName;\n\n        var branchName = _this.getBranchName(_this.props);\n\n        var postData = {\n          title: _this.state.title,\n          branch_name: branchName,\n          repo_name: repoName,\n          repo_data: _this.props.repoData\n        };\n        axios.defaults.headers.common['X-CSRFToken'] = csrftoken;\n        axios.post('/tutorials/create_or_get', postData).then(function (response) {\n          var data = response.data;\n\n          if (data.created) {\n            _this.setState({\n              loading: false\n            });\n\n            if (data.tutorial_data.repository_name) {\n              _this.props.history.push(\"/create/\" + repoName + \"/\" + data.tutorial_data.id + \"/\" + data.tutorial_data.slug + \"/\" + branchName);\n            } else {\n              _this.props.history.push(\"/create/new/\" + data.tutorial_data.id + \"/\" + data.tutorial_data.slug);\n            }\n          } else {\n            _this.setState({\n              loading: false,\n              emptyError: true,\n              error: \"A story with this name already exists\"\n            });\n          }\n        }).catch(function (error) {\n          console.log(error);\n\n          _this.setState({\n            error: error\n          });\n        });\n      }\n    };\n\n    var _repoName = _props.match.params.repoName;\n\n    var _branchName = _this.getBranchName(_props);\n\n    _this.state = {\n      title: \"\",\n      error: null,\n      emptyError: false,\n      tutorials: null,\n      repoName: _repoName,\n      branchName: _branchName\n    };\n    return _this;\n  }\n\n  _createClass(CreateTutorial, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      if (this.state.repoName && this.state.branchName) {\n        axios.get('/tutorials/?repo_name=' + this.state.repoName + \"&branch_name=\" + this.state.branchName + \"&repo_create=true\").then(function (response) {\n          _this2.setState({\n            tutorials: response.data\n          });\n        }).catch(function (error) {\n          console.log(error);\n\n          _this2.setState({\n            error: error,\n            loading: false\n          });\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var classes = this.props.classes;\n      var repoName = this.props.match.params.repoName;\n      var branchName = this.getBranchName(this.props);\n      var tutorials = this.state.tutorials ? this.state.tutorials.results.map(function (tutorial, index) {\n        return React.createElement(MediaCard, {\n          key: tutorial.id,\n          link: \"/create/\" + repoName + \"/\" + tutorial.id + \"/\" + tutorial.slug + \"/\" + branchName,\n          content: React.createElement(TutorialInfo, {\n            user: tutorial.user,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 148\n            },\n            __self: this\n          }),\n          title: tutorial.title,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 145\n          },\n          __self: this\n        });\n      }) : null;\n      return React.createElement(React.Fragment, null, React.createElement(\"div\", {\n        className: classes.container,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155\n        },\n        __self: this\n      }, React.createElement(React.Fragment, null, React.createElement(TextField, {\n        error: this.state.emptyError,\n        id: \"outlined-name\",\n        label: \"Title of your story\",\n        value: this.state.title,\n        onChange: this.titleUpdate,\n        className: classes.textField,\n        margin: \"normal\",\n        variant: \"outlined\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157\n        },\n        __self: this\n      }), React.createElement(\"p\", {\n        style: {\n          color: 'red',\n          paddingLeft: '10px'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167\n        },\n        __self: this\n      }, this.state.error), React.createElement(Fab, {\n        variant: \"extended\",\n        onClick: this.createTutorial,\n        disabled: this.state.loading,\n        size: \"medium\",\n        color: \"primary\",\n        \"aria-label\": \"Add\",\n        className: classes.margin,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169\n        },\n        __self: this\n      }, React.createElement(IconContext.Provider, {\n        value: {\n          size: '2em'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178\n        },\n        __self: this\n      }, React.createElement(MdGrade, {\n        className: classes.extendedIcon,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179\n        },\n        __self: this\n      })), \"Create your Story\")), tutorials ? tutorials.length > 0 ? React.createElement(React.Fragment, null, React.createElement(\"h4\", {\n        className: classes.margin,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 188\n        },\n        __self: this\n      }, \"Stories with this branch and repo\"), tutorials) : null : null));\n    }\n  }]);\n\n  return CreateTutorial;\n}(React.Component);\n\nvar connectStateToProps = function connectStateToProps(state) {\n  return {\n    repoData: state.rdReducer.repoData\n  };\n};\n\nexport default withErrorHandler(withStyles(styles)(withRouter(connect(connectStateToProps, null)(CreateTutorial))), axios, \"circular\");","map":{"version":3,"sources":["/home/shahrukh/Code/projects/allywith/Codeilm.com/lovecode/lovecodefrontend/lovecode/src/containers/CreateTutorial/CreateTutorial.js"],"names":["React","axios","withErrorHandler","withStyles","TextField","withRouter","Fab","MdGrade","IconContext","getCookie","MediaCard","TutorialInfo","connect","styles","theme","textField","width","margin","spacing","repoField","minWidth","container","position","top","textTransform","extendedIcon","marginRight","CreateTutorial","props","getBranchName","query","URLSearchParams","location","search","entries","param","titleUpdate","event","setState","title","target","value","emptyError","error","createTutorial","prevState","loading","state","csrftoken","repoName","match","params","branchName","postData","branch_name","repo_name","repo_data","repoData","defaults","headers","common","post","then","response","data","created","tutorial_data","repository_name","history","push","id","slug","catch","console","log","tutorials","get","classes","results","map","tutorial","index","user","color","paddingLeft","size","length","Component","connectStateToProps","rdReducer"],"mappings":"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","sourcesContent":["import React from 'react'\nimport axios from '../../lovecodeaxios'\nimport withErrorHandler from '../../hoc/withErrorHandler/withErrorHandler'\nimport { withStyles } from '@material-ui/core/styles';\nimport TextField from '@material-ui/core/TextField';\nimport { withRouter } from \"react-router\";\nimport Fab from '@material-ui/core/Fab';\nimport { MdGrade } from 'react-icons/md';\nimport { IconContext } from \"react-icons\";\nimport getCookie from '../../utils/getCookie'\nimport MediaCard from '../../components/UI/MediaCard/MediaCard'\nimport TutorialInfo from '../../components/TutorialInfo/TutorialInfo'\nimport { connect } from 'react-redux'\n\nconst styles = theme => ({\n  textField: {\n    width: '95%',\n    margin: theme.spacing()\n  },\n  repoField: {\n    minWidth: 120,\n    margin: theme.spacing()\n  },\n  container: {\n    position: 'absolute',\n    top: '90px',\n    width: '95%'\n  },\n  margin: {\n    margin: theme.spacing(),\n    textTransform: 'none'\n  },\n  extendedIcon: {\n    marginRight: theme.spacing(),\n  }\n});\n\nclass CreateTutorial extends React.Component {\n\n  getBranchName = (props) => {\n    const query = new URLSearchParams( props.location.search );\n    for ( let param of query.entries() ) {\n      if (param[0] === 'branch_name') {\n        return param[1];\n      }\n    }\n    return null\n  }\n\n  constructor(props) {\n\n    super(props)\n    const { repoName } = props.match.params;\n    const branchName = this.getBranchName(props);\n\n    this.state = {\n      title: \"\",\n      error: null,\n      emptyError: false,\n      tutorials: null,\n      repoName: repoName,\n      branchName: branchName\n    }\n  }\n\n  titleUpdate = event => {\n    this.setState({\n      title: event.target.value,\n      emptyError: event.target.value === \"\" ? true : false,\n      error: null,\n    })\n  }\n\n  componentDidMount() {\n\n    if(this.state.repoName && this.state.branchName) {\n      axios.get('/tutorials/?repo_name=' + this.state.repoName + \"&branch_name=\" + this.state.branchName + \"&repo_create=true\")\n      .then(response => {\n        this.setState({\n          tutorials: response.data\n        })\n      })\n      .catch(error => {\n        console.log(error)\n        this.setState({\n          error: error,\n          loading: false\n        })\n      })\n    }\n  }\n\n  createTutorial = () => {\n    this.setState((prevState, props) => {\n      return {\n        loading: prevState.title === \"\" ? false: true,\n        emptyError: prevState.title === \"\" ? true: false,\n        error: prevState.title === \"\" ? \"Title can't be blank\": null\n      }\n    })\n    if(this.state.title !== \"\") {\n      const csrftoken = getCookie('csrftoken');\n      const { repoName } = this.props.match.params;\n      const branchName = this.getBranchName(this.props)\n      const postData = {\n        title: this.state.title,\n        branch_name: branchName,\n        repo_name: repoName,\n        repo_data: this.props.repoData\n      };\n      axios.defaults.headers.common['X-CSRFToken'] = csrftoken;\n      axios.post('/tutorials/create_or_get', postData)\n      .then(response => {\n        const data = response.data;\n        if(data.created) {\n          this.setState({loading: false})\n          if(data.tutorial_data.repository_name) {\n            this.props.history.push(\"/create/\" + repoName + \"/\" + data.tutorial_data.id + \"/\" + data.tutorial_data.slug + \"/\" + branchName)\n          }\n          else {\n            this.props.history.push(\"/create/new/\" + data.tutorial_data.id + \"/\" + data.tutorial_data.slug)\n          }\n        }\n        else {\n          this.setState({loading: false, emptyError: true, error: \"A story with this name already exists\"})\n        }\n\n      })\n      .catch(error => {\n        console.log(error);\n        this.setState({\n          error: error,\n        })\n      })\n\n    }\n  }\n\n  render() {\n    const { classes } = this.props;\n    const { repoName } = this.props.match.params;\n    const branchName = this.getBranchName(this.props)\n    const tutorials = this.state.tutorials ?\n    this.state.tutorials.results.map((tutorial, index) => {\n      return <MediaCard\n        key={tutorial.id}\n        link={\"/create/\" + repoName + \"/\" + tutorial.id + \"/\" + tutorial.slug + \"/\" + branchName}\n        content=<TutorialInfo user={tutorial.user} />\n        title={tutorial.title} />\n    })\n     : null;\n    return (\n      <>\n\n      <div className={classes.container}>\n      <>\n        <TextField\n          error={this.state.emptyError}\n          id=\"outlined-name\"\n          label=\"Title of your story\"\n          value={this.state.title}\n          onChange={this.titleUpdate}\n          className={classes.textField}\n          margin=\"normal\"\n          variant=\"outlined\"\n        />\n        <p style={{color: 'red', paddingLeft: '10px'}}>{this.state.error}</p>\n\n        <Fab\n          variant=\"extended\"\n          onClick={this.createTutorial}\n          disabled={this.state.loading}\n          size=\"medium\"\n          color=\"primary\"\n          aria-label=\"Add\"\n          className={classes.margin}\n        >\n          <IconContext.Provider value={{ size: '2em' }}>\n          <MdGrade className={classes.extendedIcon} />\n          </IconContext.Provider>\n          Create your Story\n        </Fab>\n        </>\n\n        {tutorials ?\n            tutorials.length > 0 ?\n              <>\n              <h4 className={classes.margin}>Stories with this branch and repo</h4>\n              {tutorials}\n              </>\n              : null\n        : null}\n\n        </div>\n      </>\n    )\n  }\n}\n\nconst connectStateToProps = state => {\n  return {\n    repoData: state.rdReducer.repoData\n  }\n}\n\nexport default withErrorHandler(withStyles(styles)(withRouter(connect(connectStateToProps, null)(CreateTutorial))), axios, \"circular\")\n"]},"metadata":{},"sourceType":"module"}